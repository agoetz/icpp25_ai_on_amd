#!/bin/bash
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=4
#SBATCH --cpus-per-task=48
#SBATCH --exclusive
#SBATCH --time=00:10:00

export FI_CXI_ATS=0
export LD_LIBRARY_PATH=/cosmos/vast/scratch/train101/icpp2025/rccl/build:/cosmos/vast/scratch/train101/icpp2025/ofi-rccl/lib64:/opt/cray/libfabric/1.20.1/lib64:/opt/rocm-6.3.0/lib:$LD_LIBRARY_PATH
export NCCL_NET_GDR_LEVEL=3
export HSA_NO_SCRATCH_RECLAIM=1
srun --nodes=1 -n 4 /cosmos/vast/scratch/train101/icpp2025/rccl-tests/build/all_reduce_perf -b 8 -e 16G -f 2 -g 1 
